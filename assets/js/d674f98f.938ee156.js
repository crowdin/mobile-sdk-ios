"use strict";(self.webpackChunk_crowdin_mobile_sdk_ios_website=self.webpackChunk_crowdin_mobile_sdk_ios_website||[]).push([[441],{6823:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"guides/screenshots-automation","title":"Screenshots Automation","description":"This guide shows how to automate the process of taking screenshots and uploading them to Crowdin to provide context for translators or AI. It covers the necessary setup, how to use the Crowdin SDK, and a sample automation test.","source":"@site/docs/guides/screenshots-automation.md","sourceDirName":"guides","slug":"/guides/screenshots-automation","permalink":"/mobile-sdk-ios/guides/screenshots-automation","draft":false,"unlisted":false,"editUrl":"https://github.com/crowdin/mobile-sdk-ios/tree/master/website/docs/guides/screenshots-automation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"SDK Controls","permalink":"/mobile-sdk-ios/advanced-features/sdk-controls"},"next":{"title":"Debug and Logging","permalink":"/mobile-sdk-ios/guides/debug-and-logging"}}');var s=t(4848),o=t(8453);const r={},a="Screenshots Automation",c={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setting Up the Crowdin SDK",id:"setting-up-the-crowdin-sdk",level:2},{value:"Installation",id:"installation",level:3},{value:"CocoaPods",id:"cocoapods",level:4},{value:"Swift Package Manager",id:"swift-package-manager",level:4},{value:"Key Configuration Options",id:"key-configuration-options",level:3},{value:"Main App Configuration",id:"main-app-configuration",level:4},{value:"UI Tests Configuration",id:"ui-tests-configuration",level:4},{value:"App UI Testing Mode Setup",id:"app-ui-testing-mode-setup",level:4},{value:"Capturing Screenshots with Crowdin SDK",id:"capturing-screenshots-with-crowdin-sdk",level:2},{value:"Example Automation Test",id:"example-automation-test",level:2},{value:"Example",id:"example",level:3},{value:"Conclusion",id:"conclusion",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"screenshots-automation",children:"Screenshots Automation"})}),"\n",(0,s.jsx)(n.p,{children:"This guide shows how to automate the process of taking screenshots and uploading them to Crowdin to provide context for translators or AI. It covers the necessary setup, how to use the Crowdin SDK, and a sample automation test."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Before you start, ensure you have:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"An iOS app project with UI Tests target"}),"\n",(0,s.jsx)(n.li,{children:"Crowdin API access token with Screenshots scope"}),"\n",(0,s.jsx)(n.li,{children:"Distribution hash from your Crowdin project"}),"\n",(0,s.jsx)(n.li,{children:"Source language code configured in your Crowdin project"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"setting-up-the-crowdin-sdk",children:"Setting Up the Crowdin SDK"}),"\n",(0,s.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.p,{children:"First, add the screenshot feature to your UI Tests target. You can use either CocoaPods or Swift Package Manager."}),"\n",(0,s.jsx)(n.h4,{id:"cocoapods",children:"CocoaPods"}),"\n",(0,s.jsxs)(n.p,{children:["Add the following to your ",(0,s.jsx)(n.code,{children:"Podfile"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ruby",children:"target 'YourAppUITests' do\n  pod 'CrowdinSDK/CrowdinTestScreenshots'\nend\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pod install\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then add import to your tests source files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"import CrowdinSDK\n"})}),"\n",(0,s.jsx)(n.h4,{id:"swift-package-manager",children:"Swift Package Manager"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"In Xcode, go to File > Add Packages"}),"\n",(0,s.jsxs)(n.li,{children:["Add package with URL: ",(0,s.jsx)(n.code,{children:"https://github.com/crowdin/mobile-sdk-ios"})]}),"\n",(0,s.jsx)(n.li,{children:'Select "CrowdinTestScreenshots" product when adding the package'}),"\n",(0,s.jsx)(n.li,{children:"Add the package to your UI Tests target"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Or add it to your Package.swift:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'dependencies: [\n    .package(url: "https://github.com/crowdin/mobile-sdk-ios.git", .upToNextMajor(from: "VERSION"))\n],\ntargets: [\n    .target(\n        name: "YourUITests",\n        dependencies: [\n            .product(name: "CrowdinTestScreenshots", package: "CrowdinSDK")\n        ]\n    )\n]\n'})}),"\n",(0,s.jsx)(n.p,{children:"Then add imports in your tests source files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"import CrowdinSDK\nimport CrowdinTestScreenshots\n"})}),"\n",(0,s.jsx)(n.h3,{id:"key-configuration-options",children:"Key Configuration Options"}),"\n",(0,s.jsx)(n.p,{children:"To enable screenshots automation feature, you need to configure several components."}),"\n",(0,s.jsx)(n.admonition,{title:"Notes",type:"note",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"To enable screenshots tag you need to setup SDK in UI tests and in the app with the same localization. Localization should be in target language on crowdin."}),"\n",(0,s.jsx)(n.li,{children:"Before you can test your application with UI Test, you need to set it up with the localization you want to test."}),"\n"]})}),"\n",(0,s.jsx)(n.h4,{id:"main-app-configuration",children:"Main App Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The main app must be configured with the same Crowdin configuration (distribution hash and source language) as the UI tests to ensure proper screenshot handling. If your app is configured with the SDK Controls button, it should be disabled during UI tests to prevent it from appearing in screenshots. See the ",(0,s.jsx)(n.a,{href:"#app-ui-testing-mode-setup",children:"App UI Testing Mode Setup"})," section for implementation details."]}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"If you want to have screenshots tagged for source language you need to ensure it's added to target languages."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let crowdinProviderConfig = CrowdinProviderConfig(hashString: "{distribution_hash}",\n                                                sourceLanguage: "{source_language}")\n\nlet crowdinSDKConfig = CrowdinSDKConfig.config()\n    .with(crowdinProviderConfig: crowdinProviderConfig)\n    .with(settingsEnabled: !isTesting) // Disable settings button during UI tests if it\'s enabled.\n\nCrowdinSDK.startWithConfig(crowdinSDKConfig)\n'})}),"\n",(0,s.jsx)(n.h4,{id:"ui-tests-configuration",children:"UI Tests Configuration"}),"\n",(0,s.jsx)(n.p,{children:"For UI testing it's recommended to use the access token authorization:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let crowdinProviderConfig = CrowdinProviderConfig(hashString: "{distribution_hash}",\n                                                sourceLanguage: "{source_language}")\n\nlet crowdinSDKConfig = CrowdinSDKConfig.config()\n    .with(crowdinProviderConfig: crowdinProviderConfig)\n    .with(accessToken: "{access_token}") \n    .with(screenshotsEnabled: true)\n\nCrowdinSDK.startWithConfigSync(crowdinSDKConfig)\n'})}),"\n",(0,s.jsx)(n.h4,{id:"app-ui-testing-mode-setup",children:"App UI Testing Mode Setup"}),"\n",(0,s.jsxs)(n.p,{children:["Add the ",(0,s.jsx)(n.code,{children:"CROWDIN_UI_TESTING"})," launch argument to your tests so that you can set up your app for UI testing.  For example, if you use the SDK Controls button in debug - you can disable it and it won't be visible on your screenshots."]}),"\n",(0,s.jsx)(n.p,{children:"To add the launch argument you need to do the following in your tests:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let app = XCUIApplication()\napp.launchArguments = ["CROWDIN_UI_TESTING"]\napp.launch()\n'})}),"\n",(0,s.jsx)(n.p,{children:"As you can see, the application has been launched through tests:"}),"\n",(0,s.jsx)(n.p,{children:"Using AppDelegate:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n    if ProcessInfo.processInfo.arguments.contains("CROWDIN_UI_TESTING") {\n        // Set up test data, mock services, etc.\n        setupTestEnvironment()\n    } else {\n        // Normal app initialization\n        setupNormalEnvironment()\n    }\n    return true\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Using SceneDelegate:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {\n    guard let windowScene = (scene as? UIWindowScene) else { return }\n    \n    if ProcessInfo.processInfo.arguments.contains("CROWDIN_UI_TESTING") {\n        // Set up test data, mock services, etc.\n        setupTestEnvironment(windowScene: windowScene)\n    } else {\n        // Normal app initialization\n        setupNormalEnvironment(windowScene: windowScene)\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Required Parameters:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"accessToken"})}),(0,s.jsx)(n.td,{children:"Crowdin API access token with Screenshots scope (required for UI tests only)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"screenshotsEnabled"})}),(0,s.jsx)(n.td,{children:"Boolean flag to enable screenshots feature (required for UI tests only)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"distributionHash"})}),(0,s.jsx)(n.td,{children:"Distribution Hash (required for both main app and UI tests)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sourceLanguage"})}),(0,s.jsx)(n.td,{children:"Source language code (required for both main app and UI tests)"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"capturing-screenshots-with-crowdin-sdk",children:"Capturing Screenshots with Crowdin SDK"}),"\n",(0,s.jsx)(n.p,{children:"The SDK provides a synchronous method for capturing screenshots:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"CrowdinSDK.captureOrUpdateScreenshotSync(\n    name: String,\n    image: UIImage,\n    application: XCUIApplication\n) -> (result: ScreenshotUploadResult?, error: Error?)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Parameters:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"name"})}),(0,s.jsx)(n.td,{children:"Unique identifier for the screenshot"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"image"})}),(0,s.jsx)(n.td,{children:"UIImage object of the screenshot"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"application"})}),(0,s.jsx)(n.td,{children:"XCUIApplication instance for context"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"The method returns a tuple containing:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"success"})," (ScreenshotUploadResult?): Uploading result: new or updated"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error"})," (Error?): Second element containing error if operation failed"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example-automation-test",children:"Example Automation Test"}),"\n",(0,s.jsx)(n.p,{children:"Here's a complete example of implementing UI tests for automated screenshot capture:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'import XCTest\nimport CrowdinSDK\n\nfinal class ScreenshotsUITests: XCTestCase {\n    \n    private static let distributionHash = "{distribution_hash}"\n    private static let sourceLanguage = "{source_language}"\n    private static let accessToken = "{access_token}"\n    \n    override class func setUp() {\n        // Configure SDK for UI Testing\n        let crowdinProviderConfig = CrowdinProviderConfig(hashString: Self.distributionHash,\n                                                        sourceLanguage: Self.sourceLanguage)\n        \n        let crowdinSDKConfig = CrowdinSDKConfig.config()\n            .with(crowdinProviderConfig: crowdinProviderConfig)\n            .with(accessToken: Self.accessToken)\n            .with(screenshotsEnabled: true)\n        \n        CrowdinSDK.startWithConfigSync(crowdinSDKConfig)\n    }\n    \n    override class func tearDown() {\n        CrowdinSDK.stop()\n        CrowdinSDK.deintegrate()\n    }\n    \n    @MainActor\n    func testScreenshots() throws {\n        let app = XCUIApplication()\n        // Recommended: Add launch argument to enable UI testing mode\n        app.launchArguments = ["CROWDIN_UI_TESTING"]\n        app.launch()\n        \n        // Capture main screen\n        let result = CrowdinSDK.captureOrUpdateScreenshotSync(\n            name: "MAIN_SCREEN", \n            image: XCUIScreen.main.screenshot().image,\n            application: app\n        )\n        XCTAssertNil(result.error) // Verify no errors occurred\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.p,{children:"Key implementation points from the example:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Testing Source Language Localization"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'final class AppleRemindersUITestsCrowdinScreenhsotTests: XCTestCase {\n    private static let distributionHash = "{distribution_hash}"\n    private static let sourceLanguage = "{source_language}"\n    private static let accessToken = "{access_token}"\n    \n    override class func setUp() {\n        // Requires to start SDK before running testScreenshots as it needs to get all supported localizations from Crowdin.\n        startSDK(localization: sourceLanguage)\n    }\n\n    class func startSDK(localization: String) {\n        let crowdinProviderConfig = CrowdinProviderConfig(hashString: Self.distributionHash,\n                                                          sourceLanguage: Self.sourceLanguage)\n        \n        let crowdinSDKConfig = CrowdinSDKConfig.config()\n            .with(crowdinProviderConfig: crowdinProviderConfig)\n            .with(accessToken: Self.accessToken)\n            .with(screenshotsEnabled: true)\n        \n        CrowdinSDK.currentLocalization = localization\n        \n        CrowdinSDK.startWithConfigSync(crowdinSDKConfig)\n    }\n    \n    @MainActor\n    func testScreenshots() throws {\n        XCTAssert(CrowdinSDK.inSDKLocalizations.count > 0, "At least one target language should be set up in Crowdin.")\n        \n        let app = XCUIApplication()\n        // Pass selected localization in test to the app.\n        app.launchArguments = ["UI_TESTING", "CROWDIN_LANGUAGE_CODE=\\(Self.sourceLanguage)"]\n        app.launch()\n        \n        let addListBtn = app.otherElements.buttons.element(matching: .button, identifier: "addListBtn")\n        _ = app.waitForExistence(timeout: 5) // Timeout for app to start SDK and show UI.\n        \n        // MAIN SCREEN\n        var result = CrowdinSDK.captureOrUpdateScreenshotSync(name: "MAIN_SCREEN_\\(Self.sourceLanguage)", image: XCUIScreen.main.screenshot().image, application: app)\n        XCTAssertNil(result.error)\n    }\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["For a more comprehensive example of screenshot automation with multiple localizations, you can refer to our ",(0,s.jsx)(n.a,{href:"https://github.com/crowdin/mobile-sdk-ios/blob/xctests-support/Example/AppleRemindersUITests/AppleRemindersUITestsCrowdinScreenhsotTests.swift",children:"example UI tests"})," and corresponding ",(0,s.jsx)(n.a,{href:"https://github.com/crowdin/mobile-sdk-ios/blob/xctests-support/Example/AppleReminders/SceneDelegate.swift",children:"app configuration"}),"."]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"App Configuration for Test Mode"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'// In SceneDelegate\nlet arguments = ProcessInfo.processInfo.arguments\nlet isTesting = arguments.contains("UI_TESTING")\n\nif isTesting, let locale = arguments.first(where: { $0.contains("CROWDIN_LANGUAGE_CODE") })?.split(separator: "=").last.map({ String($0) }) {\n    // Configure SDK for testing with specific locale\n    let crowdinSDKConfig = CrowdinSDKConfig.config()\n        .with(crowdinProviderConfig: crowdinProviderConfig)\n        .with(accessToken: Self.accessToken)\n        .with(screenshotsEnabled: true)\n    \n    CrowdinSDK.currentLocalization = locale\n    \n    CrowdinSDK.startWithConfig(crowdinSDKConfig) {\n        // Initialize UI after SDK is configured\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"Best Practices for Screenshot Automation:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Use descriptive screenshot names that reflect the screen or feature being captured"}),"\n",(0,s.jsx)(n.li,{children:"Always use UI testing mode launch argument to ensure consistent test environment"}),"\n",(0,s.jsx)(n.li,{children:"Set up appropriate test data in your app when CROWDIN_UI_TESTING argument is detected"}),"\n",(0,s.jsx)(n.li,{children:"Verify screenshot capture results using XCTAssertNil(result.error)"}),"\n",(0,s.jsx)(n.li,{children:"Clean up resources in tearDown method"}),"\n",(0,s.jsx)(n.li,{children:"When testing multiple localizations, ensure proper communication of locale between tests and app"}),"\n",(0,s.jsx)(n.li,{children:"Use localization-specific screenshot names for better organization"}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"Make sure your access token has the necessary permissions for screenshot management."})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(6540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);